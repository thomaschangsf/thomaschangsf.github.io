

<!doctype html>






<html  data-paige="Paige theme from https://github.com/willfaught/paige"   lang="en" >

    










    

    

    

    

    

    

    

    

    




<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    

    

<meta charset="utf-8">




    <meta content="Comprehensive overview of Kubernetes" name="description">




<meta content="#0d6efd" name="msapplication-TileColor">


    <meta content="/browserconfig.xml" name="msapplication-config">


<meta content="https://github.com/willfaught/paige" name="theme">
<meta content="#0d6efd" name="theme-color">
<meta content="width=device-width, initial-scale=1" name="viewport">

<meta property="og:url" content="http://localhost:1313/books/software-system/kubernetes-up-and-running/">
  <meta property="og:title" content="Kubernetes Up and Running">
  <meta property="og:description" content="Comprehensive overview of Kubernetes">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="books">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Kubernetes Up and Running">
  <meta name="twitter:description" content="Comprehensive overview of Kubernetes">



    
        <title>Kubernetes Up and Running · Software System ·  · Paige</title>
    

    


    <link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">



    <link href="/favicon.ico" rel="shortcut icon">



    <link href="/favicon.png" rel="icon" type="image/png">



    <link href="/favicon.svg" rel="icon" type="image/svg+xml">



    <link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">



    <link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">



    <link color="#0d6efd" href="/safari-pinned-tab.svg" rel="mask-icon">



    <link href="/site.webmanifest" rel="manifest">
























    

    
        
        
        
    

    
        
    

    
    
    


<link  crossorigin="anonymous"  href="/css/paige/bootstrap/6186ad141d391e4c0c10d2e9cb4eaeaadf75e809-paige.min.5a695f13e40d00e33dc2ef3b080efa570bbcc6991647824214ff6d7f4b20527e.css"  integrity="sha256-WmlfE&#43;QNAOM9wu87CA76Vwu8xpkWR4JCFP9tf0sgUn4="   referrerpolicy="no-referrer"  rel="stylesheet">



















    

    

    

    
    
    


<link  crossorigin="anonymous"  href="/css/paige/bootstrap-icons/bootstrap-icons.min.540116b7267d4b2410c74086ae6497566928c6d5715900be7ce7279ad45addcd.css"  integrity="sha256-VAEWtyZ9SyQQx0CGrmSXVmkoxtVxWQC&#43;fOcnmtRa3c0="   referrerpolicy="no-referrer"  rel="stylesheet">



    

















    

    

    

    
    
    


<link  crossorigin="anonymous"  href="/css/paige/katex/katex.min.min.c12d9cca9aa0af743d947ef8c8f5fabaad13e5b4c9fed061fbdf7c9d3c387581.css"  integrity="sha256-wS2cypqgr3Q9lH74yPX6uq0T5bTJ/tBh&#43;998nTw4dYE="   referrerpolicy="no-referrer"  rel="stylesheet">





    

<style>


.paige-figure-numbered {
    counter-increment: paige-figure-numbered;
}

.paige-figure-numbered > div > figure > figcaption::before {
    content: "Figure " counter(paige-figure-numbered) ": ";
}

.paige-figure-numbered > div > figure > figcaption:empty::before {
    content: "Figure " counter(paige-figure-numbered);
}

.paige-header-link {
    opacity: 0;
    margin-left: 0.5rem;
    position: absolute;
    transition: color 0.15s ease-in-out, opacity 0.15s ease-in-out;
}

.paige-header-link::after {
    content: "#";
}

.paige-quote .blockquote-footer {
    margin-top: 0;
}

.paige-quote blockquote {
    border-left: 0;
    border-right: 0;
    margin-bottom: 0;
    padding: 0;
}

#paige-content > * {
    margin-bottom: 1rem;
}

blockquote {
    padding: 0.5rem 1rem;
    border-left: 0.25rem solid var(--bs-border-color);
    border-right: 0.25rem solid var(--bs-body-bg);
}

td, th {
    padding: 0.25rem;
}

.highlight .chroma .hl,
.highlight .chroma .lnt {
    display: flex;
}

.paige-figure .paige-quote,
.paige-figure .paige-video,
.paige-figure .highlight pre.chroma,
.paige-figure .highlight .chroma pre,
.paige-figure .paige-quote blockquote,
.paige-figure figure > div > :last-child,
.paige-gallery .paige-figure,
.paige-gallery .paige-image,
blockquote > p:last-of-type {
    margin-bottom: 0;
}

.paige-figure,
.paige-gallery,
.paige-image,
.paige-quote,
.paige-video,
table {
    margin-bottom: 1rem;
}

.paige-header-link:focus,
.paige-header-link:hover,
:hover > .paige-header-link,
:target > .paige-header-link {
    opacity: 1;
}




    @media (prefers-color-scheme: dark) {
        /* Background */ .bg { color: #c9d1d9; background-color: var(--bs-body-bg); }
/* PreWrapper */ .chroma { color: #c9d1d9; background-color: var(--bs-body-bg); }
/* Other */ .chroma .x {  }
/* Error */ .chroma .err { color: #f85149 }
/* CodeLine */ .chroma .cl {  }
/* LineLink */ .chroma .lnlinks { outline: none; text-decoration: none; color: inherit }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; }
/* LineHighlight */ .chroma .hl { background-color: #4f4f4d }
/* LineNumbersTable */ .chroma .lnt { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #64686c }
/* LineNumbers */ .chroma .ln { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #6e7681 }
/* Line */ .chroma .line { display: flex; }
/* Keyword */ .chroma .k { color: #ff7b72 }
/* KeywordConstant */ .chroma .kc { color: #79c0ff }
/* KeywordDeclaration */ .chroma .kd { color: #ff7b72 }
/* KeywordNamespace */ .chroma .kn { color: #ff7b72 }
/* KeywordPseudo */ .chroma .kp { color: #79c0ff }
/* KeywordReserved */ .chroma .kr { color: #ff7b72 }
/* KeywordType */ .chroma .kt { color: #ff7b72 }
/* Name */ .chroma .n {  }
/* NameAttribute */ .chroma .na {  }
/* NameBuiltin */ .chroma .nb {  }
/* NameBuiltinPseudo */ .chroma .bp {  }
/* NameClass */ .chroma .nc { color: #f0883e; font-weight: bold }
/* NameConstant */ .chroma .no { color: #79c0ff; font-weight: bold }
/* NameDecorator */ .chroma .nd { color: #d2a8ff; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #ffa657 }
/* NameException */ .chroma .ne { color: #f0883e; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #d2a8ff; font-weight: bold }
/* NameFunctionMagic */ .chroma .fm {  }
/* NameLabel */ .chroma .nl { color: #79c0ff; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #ff7b72 }
/* NameOther */ .chroma .nx {  }
/* NameProperty */ .chroma .py { color: #79c0ff }
/* NameTag */ .chroma .nt { color: #7ee787 }
/* NameVariable */ .chroma .nv { color: #79c0ff }
/* NameVariableClass */ .chroma .vc {  }
/* NameVariableGlobal */ .chroma .vg {  }
/* NameVariableInstance */ .chroma .vi {  }
/* NameVariableMagic */ .chroma .vm {  }
/* Literal */ .chroma .l { color: #a5d6ff }
/* LiteralDate */ .chroma .ld { color: #79c0ff }
/* LiteralString */ .chroma .s { color: #a5d6ff }
/* LiteralStringAffix */ .chroma .sa { color: #79c0ff }
/* LiteralStringBacktick */ .chroma .sb { color: #a5d6ff }
/* LiteralStringChar */ .chroma .sc { color: #a5d6ff }
/* LiteralStringDelimiter */ .chroma .dl { color: #79c0ff }
/* LiteralStringDoc */ .chroma .sd { color: #a5d6ff }
/* LiteralStringDouble */ .chroma .s2 { color: #a5d6ff }
/* LiteralStringEscape */ .chroma .se { color: #79c0ff }
/* LiteralStringHeredoc */ .chroma .sh { color: #79c0ff }
/* LiteralStringInterpol */ .chroma .si { color: #a5d6ff }
/* LiteralStringOther */ .chroma .sx { color: #a5d6ff }
/* LiteralStringRegex */ .chroma .sr { color: #79c0ff }
/* LiteralStringSingle */ .chroma .s1 { color: #a5d6ff }
/* LiteralStringSymbol */ .chroma .ss { color: #a5d6ff }
/* LiteralNumber */ .chroma .m { color: #a5d6ff }
/* LiteralNumberBin */ .chroma .mb { color: #a5d6ff }
/* LiteralNumberFloat */ .chroma .mf { color: #a5d6ff }
/* LiteralNumberHex */ .chroma .mh { color: #a5d6ff }
/* LiteralNumberInteger */ .chroma .mi { color: #a5d6ff }
/* LiteralNumberIntegerLong */ .chroma .il { color: #a5d6ff }
/* LiteralNumberOct */ .chroma .mo { color: #a5d6ff }
/* Operator */ .chroma .o { color: #ff7b72; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #ff7b72; font-weight: bold }
/* Punctuation */ .chroma .p {  }
/* Comment */ .chroma .c { color: #8b949e; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #8b949e; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #8b949e; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #8b949e; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #8b949e; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #8b949e; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #8b949e; font-weight: bold; font-style: italic }
/* Generic */ .chroma .g {  }
/* GenericDeleted */ .chroma .gd { color: #ffa198; background-color: #490202 }
/* GenericEmph */ .chroma .ge { font-style: italic }
/* GenericError */ .chroma .gr { color: #ffa198 }
/* GenericHeading */ .chroma .gh { color: #79c0ff; font-weight: bold }
/* GenericInserted */ .chroma .gi { color: #56d364; background-color: #0f5323 }
/* GenericOutput */ .chroma .go { color: #8b949e }
/* GenericPrompt */ .chroma .gp { color: #8b949e }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #79c0ff }
/* GenericTraceback */ .chroma .gt { color: #ff7b72 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #6e7681 }

    }

    @media (prefers-color-scheme: light) {
        /* Background */ .bg { background-color: #ffffff; }
/* PreWrapper */ .chroma { background-color: #ffffff; }
/* Other */ .chroma .x {  }
/* Error */ .chroma .err { color: #a61717; background-color: #e3d2d2 }
/* CodeLine */ .chroma .cl {  }
/* LineLink */ .chroma .lnlinks { outline: none; text-decoration: none; color: inherit }
/* LineTableTD */ .chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
/* LineTable */ .chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; }
/* LineHighlight */ .chroma .hl { background-color: #ffffcc }
/* LineNumbersTable */ .chroma .lnt { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
/* LineNumbers */ .chroma .ln { white-space: pre; user-select: none; margin-right: 0.4em; padding: 0 0.4em 0 0.4em;color: #7f7f7f }
/* Line */ .chroma .line { display: flex; }
/* Keyword */ .chroma .k { color: #000000; font-weight: bold }
/* KeywordConstant */ .chroma .kc { color: #000000; font-weight: bold }
/* KeywordDeclaration */ .chroma .kd { color: #000000; font-weight: bold }
/* KeywordNamespace */ .chroma .kn { color: #000000; font-weight: bold }
/* KeywordPseudo */ .chroma .kp { color: #000000; font-weight: bold }
/* KeywordReserved */ .chroma .kr { color: #000000; font-weight: bold }
/* KeywordType */ .chroma .kt { color: #445588; font-weight: bold }
/* Name */ .chroma .n {  }
/* NameAttribute */ .chroma .na { color: #008080 }
/* NameBuiltin */ .chroma .nb { color: #0086b3 }
/* NameBuiltinPseudo */ .chroma .bp { color: #999999 }
/* NameClass */ .chroma .nc { color: #445588; font-weight: bold }
/* NameConstant */ .chroma .no { color: #008080 }
/* NameDecorator */ .chroma .nd { color: #3c5d5d; font-weight: bold }
/* NameEntity */ .chroma .ni { color: #800080 }
/* NameException */ .chroma .ne { color: #990000; font-weight: bold }
/* NameFunction */ .chroma .nf { color: #990000; font-weight: bold }
/* NameFunctionMagic */ .chroma .fm {  }
/* NameLabel */ .chroma .nl { color: #990000; font-weight: bold }
/* NameNamespace */ .chroma .nn { color: #555555 }
/* NameOther */ .chroma .nx {  }
/* NameProperty */ .chroma .py {  }
/* NameTag */ .chroma .nt { color: #000080 }
/* NameVariable */ .chroma .nv { color: #008080 }
/* NameVariableClass */ .chroma .vc { color: #008080 }
/* NameVariableGlobal */ .chroma .vg { color: #008080 }
/* NameVariableInstance */ .chroma .vi { color: #008080 }
/* NameVariableMagic */ .chroma .vm {  }
/* Literal */ .chroma .l {  }
/* LiteralDate */ .chroma .ld {  }
/* LiteralString */ .chroma .s { color: #dd1144 }
/* LiteralStringAffix */ .chroma .sa { color: #dd1144 }
/* LiteralStringBacktick */ .chroma .sb { color: #dd1144 }
/* LiteralStringChar */ .chroma .sc { color: #dd1144 }
/* LiteralStringDelimiter */ .chroma .dl { color: #dd1144 }
/* LiteralStringDoc */ .chroma .sd { color: #dd1144 }
/* LiteralStringDouble */ .chroma .s2 { color: #dd1144 }
/* LiteralStringEscape */ .chroma .se { color: #dd1144 }
/* LiteralStringHeredoc */ .chroma .sh { color: #dd1144 }
/* LiteralStringInterpol */ .chroma .si { color: #dd1144 }
/* LiteralStringOther */ .chroma .sx { color: #dd1144 }
/* LiteralStringRegex */ .chroma .sr { color: #009926 }
/* LiteralStringSingle */ .chroma .s1 { color: #dd1144 }
/* LiteralStringSymbol */ .chroma .ss { color: #990073 }
/* LiteralNumber */ .chroma .m { color: #009999 }
/* LiteralNumberBin */ .chroma .mb { color: #009999 }
/* LiteralNumberFloat */ .chroma .mf { color: #009999 }
/* LiteralNumberHex */ .chroma .mh { color: #009999 }
/* LiteralNumberInteger */ .chroma .mi { color: #009999 }
/* LiteralNumberIntegerLong */ .chroma .il { color: #009999 }
/* LiteralNumberOct */ .chroma .mo { color: #009999 }
/* Operator */ .chroma .o { color: #000000; font-weight: bold }
/* OperatorWord */ .chroma .ow { color: #000000; font-weight: bold }
/* Punctuation */ .chroma .p {  }
/* Comment */ .chroma .c { color: #999988; font-style: italic }
/* CommentHashbang */ .chroma .ch { color: #999988; font-style: italic }
/* CommentMultiline */ .chroma .cm { color: #999988; font-style: italic }
/* CommentSingle */ .chroma .c1 { color: #999988; font-style: italic }
/* CommentSpecial */ .chroma .cs { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreproc */ .chroma .cp { color: #999999; font-weight: bold; font-style: italic }
/* CommentPreprocFile */ .chroma .cpf { color: #999999; font-weight: bold; font-style: italic }
/* Generic */ .chroma .g {  }
/* GenericDeleted */ .chroma .gd { color: #000000; background-color: #ffdddd }
/* GenericEmph */ .chroma .ge { color: #000000; font-style: italic }
/* GenericError */ .chroma .gr { color: #aa0000 }
/* GenericHeading */ .chroma .gh { color: #999999 }
/* GenericInserted */ .chroma .gi { color: #000000; background-color: #ddffdd }
/* GenericOutput */ .chroma .go { color: #888888 }
/* GenericPrompt */ .chroma .gp { color: #555555 }
/* GenericStrong */ .chroma .gs { font-weight: bold }
/* GenericSubheading */ .chroma .gu { color: #aaaaaa }
/* GenericTraceback */ .chroma .gt { color: #aa0000 }
/* GenericUnderline */ .chroma .gl { text-decoration: underline }
/* TextWhitespace */ .chroma .w { color: #bbbbbb }

    }


@media (prefers-reduced-motion: reduce) {
    .paige-header-link {
        transition: none;
    }
}




</style>


    
</head>

    <body class="d-flex flex-column">

        

        <div class="container flex-fill" id="paige-root">
            <div class="row">
                <div class="col">
                    
                    


    <header class="my-3" id="paige-header">
        

        




        








    





    



    <nav>
        <ul class="align-items-center justify-content-center nav ">
            
                
                
                
                
                

                <li class="nav-item ">
                    <a   class="  nav-link   text-decoration-underline "  href="/"    >Home</a>

                    
                </li>
            
                
                
                
                
                

                <li class="nav-item ">
                    <a   class="  nav-link   text-decoration-underline "  href="/blogs/"    >Blogs</a>

                    
                </li>
            
                
                
                
                
                

                <li class="nav-item ">
                    <a  aria-current="page"   class=" active  text-body-emphasis    nav-link   text-decoration-underline "  href="/books/"    >Books</a>

                    
                </li>
            
                
                
                
                
                

                <li class="nav-item ">
                    <a   class="  nav-link   text-decoration-underline "  href="/resume/"    >Resume</a>

                    
                </li>
            
                
                
                
                
                

                <li class="nav-item ">
                    <a   class="  nav-link   text-decoration-underline "  href="/search/"    >Search</a>

                    
                </li>
            
                
                
                
                
                

                <li class="nav-item ">
                    <a   class="  nav-link   text-decoration-underline "  href="/tags/"    >Tags</a>

                    
                </li>
            
        </ul>
    </nav>


        

        
    </header>



                    <main class="mt-3" id="paige-main">
                        

                        



















    



    
        
    




<article  class="paige-published paige-single"  id="paige-article">
    <div class="align-items-center d-flex flex-column mb-0">
        













<div class="mw-100" id="paige-metadata">
    
        <h1 class="fw-bold text-center" id="paige-title">Kubernetes Up and Running</h1>
    

    
        <p class="lead text-center" id="paige-description">Comprehensive overview of Kubernetes</p>
    

    
        <div class="mb-3">
            

            

            

            

            
                <p class="mb-0 text-center text-secondary" id="paige-reading-time">25 minutes</p>
            
        </div>
    
</div>

        



        


    <div class="mw-100" id="paige-toc">
        <div class="border mb-3 pe-3 ps-3 pt-3 rounded">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#container-images">Container Images</a></li>
        <li><a href="#building-application-images-with-docker">Building Application Images With Docker</a></li>
        <li><a href="#multistage-image-builds">Multistage Image Builds</a></li>
        <li><a href="#deploying-to-artifactory">Deploying to Artifactory</a></li>
        <li><a href="#container-runtime-interface-cri">Container Runtime Interface (CRI)</a></li>
        <li><a href="#running-containers-with-dockers">Running Containers With Dockers</a></li>
        <li><a href="#cleanup">Cleanup</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#31-installing-k8s-as-a-public-cloud-provider">3.1 Installing K8s as a Public Cloud Provider</a></li>
        <li><a href="#32-installing-k8s-locally-with-minikube">3.2 Installing K8s Locally With MiniKube</a></li>
        <li><a href="#33-running-k8s-in-docker">3.3 Running K8s In Docker</a></li>
        <li><a href="#3-4-k8s-client">3. 4 K8s Client</a></li>
        <li><a href="#35-cluster-components">3.5 Cluster Components</a>
          <ol>
            <li>
              <ol>
                <li><a href="#k8s-proxy">K8s Proxy</a></li>
                <li><a href="#k8s-dns">K8s DNS</a></li>
                <li><a href="#k8s-ui">K8s UI</a></li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#41-namespaces">4.1 Namespaces</a></li>
        <li><a href="#42-contexts">4.2 Contexts</a></li>
        <li><a href="#43-viewing-k8s-api-objects">4.3 Viewing K8s API Objects</a></li>
        <li><a href="#44-create-update-destroy-k8s-objects">4.4 Create, Update, Destroy K8s Objects</a></li>
        <li><a href="#45-labeling-and-annotating-objects">4.5 Labeling and Annotating Objects</a></li>
        <li><a href="#46-debugging-commands">4.6 Debugging Commands</a></li>
        <li><a href="#47-cluster-management">4.7 Cluster Management</a></li>
        <li><a href="#48-command-autocompletion">4.8 Command Autocompletion</a></li>
        <li><a href="#49-alternative-way-of-viewing-cluster">4.9 Alternative Way of Viewing Cluster</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#labels">Labels</a></li>
        <li><a href="#label-selectors">Label Selectors</a></li>
        <li><a href="#annotations">Annotations</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#71-what-is-service-discovery">7.1 What is Service Discovery</a></li>
        <li><a href="#72-the-service-object">7.2 The Service Object</a>
          <ol>
            <li>
              <ol>
                <li><a href="#service-dns">Service DNS</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#73-looking-beyond-the-cluster">7.3 Looking Beyond the Cluster</a></li>
        <li><a href="#74-load-balancer-integrations">7.4 Load Balancer Integrations</a></li>
        <li><a href="#75-advanced-details">7.5 Advanced Details</a>
          <ol>
            <li>
              <ol>
                <li><a href="#endpoints">Endpoints</a></li>
                <li><a href="#kubeproxy-and-cluster-ips">KubeProxy and Cluster IPs</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#76-connecting-with-other-environments">7.6 Connecting With Other Environments</a></li>
        <li><a href="#77-cleanup">7.7 Cleanup</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#81-ingress-spec-vs-ingress-controller">8.1 Ingress Spec Vs Ingress Controller</a></li>
        <li><a href="#82-installing-contour">8.2 Installing Contour</a></li>
        <li><a href="#83-using-ingress">8.3 Using Ingress</a></li>
        <li><a href="#84--advance-ingress-topics-and-gotchas">8.4  Advance Ingress Topics and Gotchas</a></li>
        <li><a href="#85-alternate-ingress-implementation">8.5 Alternate Ingress Implementation</a></li>
        <li><a href="#86-future-of-ingress">8.6 Future of Ingress</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#101-your-first-deployment">10.1 Your First Deployment</a></li>
        <li><a href="#102-creating-deployment">10.2 Creating Deployment</a></li>
        <li><a href="#103-managing-deployments">10.3 Managing Deployments</a></li>
        <li><a href="#104-updating-deployments">10.4 Updating Deployments</a></li>
        <li><a href="#105-deployment-strategies">10.5 Deployment Strategies</a>
          <ol>
            <li>
              <ol>
                <li><a href="#recreate-strategy">Recreate Strategy</a></li>
                <li><a href="#rollingupdate-strategy">RollingUpdate Strategy</a></li>
                <li><a href="#slowing-rollouts-to-ensure-health">Slowing Rollouts to Ensure Health</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#106-deleting-a-deployment">10.6 Deleting a Deployment</a></li>
        <li><a href="#107-monitoring-a-deployment">10.7 Monitoring a Deployment</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#111-daemonset-scheduler">11.1 DaemonSet Scheduler</a></li>
        <li><a href="#112-creating-daemonsets">11.2 Creating DaemonSets</a></li>
        <li><a href="#113-limiting-daemsets-to-specific-nodes">11.3 Limiting DaemSets to Specific Nodes</a></li>
        <li><a href="#114-upading-a-daemsoneset">11.4 Upading a DaemsoneSet</a></li>
        <li><a href="#115-deleting-a-daemonset">11.5 Deleting a DaemonSet</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#job-patterns">Job Patterns</a></li>
        <li><a href="#cronjobs">Cronjobs</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#131-configmaps">13.1 ConfigMaps</a>
          <ol>
            <li>
              <ol>
                <li><a href="#creating-a-configmap">Creating a ConfigMap</a></li>
                <li><a href="#using-a-configmap">Using a ConfigMap</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#132-secrets">13.2 Secrets</a>
          <ol>
            <li>
              <ol>
                <li><a href="#creating-secrets">Creating Secrets</a></li>
                <li><a href="#consuming-secrets">Consuming Secrets</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#133-naming-constraints">13.3 Naming Constraints</a></li>
        <li><a href="#134-managing-configmaps-and-secrets">13.4 Managing ConfigMaps and Secrets</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#141-role-based-access-control">14.1 Role Based Access Control</a>
          <ol>
            <li>
              <ol>
                <li><a href="#identity-in-k8s">Identity in K8s</a></li>
                <li><a href="#understanding-roles-and-role-bindings">Understanding Roles and Role Bindings</a></li>
                <li><a href="#roles-and-role-bindings-in-k8s">Roles and Role Bindings in K8s</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#142-techniques-for-managing-rbac">14.2 Techniques for Managing RBAC</a>
          <ol>
            <li>
              <ol>
                <li><a href="#testing-authorization-with-can-i">Testing Authorization with can-i</a></li>
                <li><a href="#managing-rbac-in-source-control">Managing RBAC in Source Control</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#143-advanced-topics">14.3 Advanced Topics</a>
          <ol>
            <li>
              <ol>
                <li><a href="#aggregating-clusterroles">Aggregating ClusterRoles</a></li>
                <li><a href="#using-groups-for-bindings">Using Groups for Bindings</a></li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li>
          <ol>
            <li>
              <ol>
                <li><a href="#feature-encryption-and-authentication-with-mutual-tls">Feature: Encryption and Authentication with Mutual TLS</a></li>
                <li><a href="#feature-traffic-shaping">Feature: Traffic Shaping</a></li>
                <li><a href="#feature-introspection">Feature: Introspection</a></li>
                <li><a href="#do-you-really-need-service-mesh">Do You Really Need Service Mesh?</a></li>
                <li><a href="#service-mesh-landscape">Service Mesh Landscape</a></li>
              </ol>
            </li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#221-principles-to-guide-us">22.1 Principles to Guide Us</a>
          <ol>
            <li>
              <ol>
                <li><a href="#filesystems-as-the-source-of-truth">Filesystems as the Source of Truth</a></li>
                <li><a href="#role-of-code-review">Role of Code Review</a></li>
                <li><a href="#feature-gates">Feature Gates</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#222-managing-your-application-in-source-control">22.2 Managing Your Application in Source Control</a>
          <ol>
            <li>
              <ol>
                <li><a href="#file-system-layout">File System Layout</a></li>
                <li><a href="#managing-periodic-versions-of-the-deployment">Managing Periodic Versions of the Deployment</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#223-structuring-application-for-development-testing-and-deployment">22.3 Structuring Application for Development, Testing, and Deployment</a></li>
        <li><a href="#224-parameterizing-application-with-templates">22.4 Parameterizing Application with Templates</a>
          <ol>
            <li>
              <ol>
                <li><a href="#parameterizing-with-helm-and-templates">Parameterizing with Helm and Templates</a></li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#225-deploying-application-around-the-world">22.5 Deploying Application Around the World</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </div>


        




    <div class="mw-100" id="paige-content"><h1 id="1-introduction">1 Introduction<a aria-label="Link to this section" class="paige-header-link" href="#1-introduction"></a></h1>
<h1 id="2-creating-and-running-applications">2 Creating and Running Applications<a aria-label="Link to this section" class="paige-header-link" href="#2-creating-and-running-applications"></a></h1>
<h3 id="container-images">Container Images<a aria-label="Link to this section" class="paige-header-link" href="#container-images"></a></h3>
<ul>
<li>A container image is a binary package that encapsulates all of the files necessary to run a program inside of an OS container.</li>
<li>Most popular format is docker</li>
<li>Container images are constructed with a series of filesystem layers, where each layer inherits and modifies the layers that came before it</li>
<li>2 categories of images
<ul>
<li>system: mimics virtual machine and runs full boot process.  Seen as poor practice.</li>
<li>application: runs a single program</li>
</ul>
</li>
</ul>
<h3 id="building-application-images-with-docker">Building Application Images With Docker<a aria-label="Link to this section" class="paige-header-link" href="#building-application-images-with-docker"></a></h3>
<ul>
<li>Dockerfile</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="c"># Start from a Node.js 16 (LTS) image </span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> node:16</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Specify the directory inside the image in which all commands will run </span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /usr/src/app</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Copy package files and install dependencies </span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> package*.json ./<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> npm install<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> npm install express<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Copy all of the app files into the image </span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> . .<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># The default command to run when starting the container </span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span> <span class="s2">&#34;npm&#34;</span><span class="p">,</span> <span class="s2">&#34;start&#34;</span> <span class="p">]</span><span class="err">
</span></span></span></code></pre></div><ul>
<li>Commands</li>
</ul>
<pre tabindex="0"><code>docker build -t simple-node .
docker run --rm -p 3000:3000 simple-node**
</code></pre><ul>
<li>
<p>Building image efficiently:</p>
<ul>
<li>order your layers from least likely to change to most likely to change in order to optimize the image size for pushing and pulling. This is why, in Example 2-4, we copy the package*.json files and install dependencies before copying the rest of the program files</li>
</ul>
</li>
<li>
<p>==Do not mix secrets with images==</p>
<ul>
<li>Include as less content as possible</li>
</ul>
</li>
</ul>
<h3 id="multistage-image-builds">Multistage Image Builds<a aria-label="Link to this section" class="paige-header-link" href="#multistage-image-builds"></a></h3>
<ul>
<li>
<p>Build image efficiently by including only what is necessary</p>
<ul>
<li>Ex: include only the necessary binary and none of the development</li>
</ul>
</li>
<li>
<p>Docker introduced <em>multistage builds</em>. With multistage builds, rather than producing a single image, a Docker file can actually produce multiple images. Each image is considered a stage. ==Artifacts can be copied from preceding stages to the current stage==</p>
<ul>
<li>Building a container image using multistage builds can reduce your final container image size by hundreds of megabytes and thus dramatically speed up your deployment times</li>
</ul>
</li>
<li>
<p>Example: Single Image; inefficient</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> golang:1.17-alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Install Node and NPM</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apk update <span class="o">&amp;&amp;</span> apk upgrade <span class="o">&amp;&amp;</span> apk add --no-cache git nodejs bash npm<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Get dependencies for Go part of build</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> go get -u github.com/jteeuwen/go-bindata/...<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> go get github.com/tools/godep<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> go get github.com/kubernetes-up-and-running/kuard<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /go/src/github.com/kubernetes-up-and-running/kuard</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Copy all sources in</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> . .<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># This is a set of variables that the build script expects</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="k">ENV</span> <span class="nv">PKG</span><span class="o">=</span>github.com/kubernetes-up-and-running/kuard<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">ARCH</span><span class="o">=</span>amd64
</span></span><span class="line"><span class="cl"><span class="k">ENV</span> <span class="nv">VERSION</span><span class="o">=</span><span class="nb">test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Do the build. This script is part of incoming sources.</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> build/build.sh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span> <span class="s2">&#34;/go/bin/kuard&#34;</span> <span class="p">]</span><span class="err">
</span></span></span></code></pre></div><ul>
<li>Ex: Multi-stage Build
<ul>
<li>first image is built as build</li>
<li>second stage uses the build image</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="line"><span class="cl"><span class="c"># STAGE 1: Build</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> golang:1.17-alpine AS build</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Install Node and NPM</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apk update <span class="o">&amp;&amp;</span> apk upgrade <span class="o">&amp;&amp;</span> apk add --no-cache git nodejs bash npm<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Get dependencies for Go part of build</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> go get -u github.com/jteeuwen/go-bindata/...<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> go get github.com/tools/godep<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /go/src/github.com/kubernetes-up-and-running/kuard</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># Copy all sources in</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> . .<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># This is a set of variables that the build script expects</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="k">ENV</span> <span class="nv">PKG</span><span class="o">=</span>github.com/kubernetes-up-and-running/kuard<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">ARCH</span><span class="o">=</span>amd64
</span></span><span class="line"><span class="cl"><span class="k">ENV</span> <span class="nv">VERSION</span><span class="o">=</span><span class="nb">test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Do the build. Script is part of incoming sources.</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> build/build.sh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># STAGE 2: Deployment</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s"> alpine</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">USER</span><span class="s"> nobody:nobody</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> --from<span class="o">=</span>build /go/bin/kuard /kuard<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span> <span class="s2">&#34;/kuard&#34;</span> <span class="p">]</span><span class="err">
</span></span></span></code></pre></div><h3 id="deploying-to-artifactory">Deploying to Artifactory<a aria-label="Link to this section" class="paige-header-link" href="#deploying-to-artifactory"></a></h3>
<ul>
<li>Tags represent a variant of an image, like version
<ul>
<li>blue is the variant</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>docker login ...
docker tag kuard gcr.io/kuar-demo/kuard-amd64:blue
docker push gcr.io/kuar-demo/kuard-amd64:blue
</code></pre><h3 id="container-runtime-interface-cri">Container Runtime Interface (CRI)<a aria-label="Link to this section" class="paige-header-link" href="#container-runtime-interface-cri"></a></h3>
<ul>
<li>K8s defines the application deployment; CRI implements the definition for a specific OS.
<ul>
<li>For linux, CRI configures cgroups and namespaces</li>
<li>Vendor implementation
<ul>
<li>containerd-cri by Docker</li>
<li>cri-o by Red Had</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="running-containers-with-dockers">Running Containers With Dockers<a aria-label="Link to this section" class="paige-header-link" href="#running-containers-with-dockers"></a></h3>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">docker r**run -d --name kuard \
  --publish 8080:8080 \
  --memory 200m \
  --memory-swap 1G \
  --cpu-shares 1024 \
  gcr.io/kuar-demo/kuard-amd64:blue
</code></pre><ul>
<li>&ndash;publish (-p ) is port forward</li>
<li>-d means run in the background as a daemon</li>
<li>&ndash;name gives container a friendly name</li>
<li>limit the resources</li>
</ul>
<h3 id="cleanup">Cleanup<a aria-label="Link to this section" class="paige-header-link" href="#cleanup"></a></h3>
<ul>
<li>Stop and remove container</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">docker stop kuard
docker rm kuard
</code></pre><ul>
<li>Remove images</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">docker rmi &lt;_tag-name_&gt;
docker rmi &lt;_image-id_&gt;
</code></pre><h1 id="3-deploying-k8s-cluster">3 Deploying K8s Cluster<a aria-label="Link to this section" class="paige-header-link" href="#3-deploying-k8s-cluster"></a></h1>
<h3 id="31-installing-k8s-as-a-public-cloud-provider">3.1 Installing K8s as a Public Cloud Provider<a aria-label="Link to this section" class="paige-header-link" href="#31-installing-k8s-as-a-public-cloud-provider"></a></h3>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">
# Google
gcloud config set compute/zone us-west1-a
gcloud container clusters create kuar-cluster --num-nodes=3
gcloud container clusters get-credentials kuar-cluster

# AWS
eksctl create cluster
**eksctl create cluster --help**
</code></pre><h3 id="32-installing-k8s-locally-with-minikube">3.2 Installing K8s Locally With MiniKube<a aria-label="Link to this section" class="paige-header-link" href="#32-installing-k8s-locally-with-minikube"></a></h3>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">minikube start
minikube stop
minikube delete
</code></pre><h3 id="33-running-k8s-in-docker">3.3 Running K8s In Docker<a aria-label="Link to this section" class="paige-header-link" href="#33-running-k8s-in-docker"></a></h3>
<ul>
<li>Use Docker containers to simulate multiple K8s nodes instead of running on virtual machines
<ul>
<li><a href="https://kind.sigs.k8s.io/">K8s in Docker KIND</a></li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kind create cluster --wait 5m
export KUBECONFIG=&#34;$(kind get kubeconfig-path)&#34;
kubectl cluster-info
kind delete cluster
</code></pre><h3 id="3-4-k8s-client">3. 4 K8s Client<a aria-label="Link to this section" class="paige-header-link" href="#3-4-k8s-client"></a></h3>
<ul>
<li>kubectl (ktl)</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal"># Verify health of cluster components: scheduler, controller-manager, etcd0
kubectl get componentstatuses

# List the cluster nodes
kubectl get nodes

# Describe a specific node
ktl describe nodes kube1
</code></pre><h3 id="35-cluster-components">3.5 Cluster Components<a aria-label="Link to this section" class="paige-header-link" href="#35-cluster-components"></a></h3>
<ul>
<li>Runs in the kube-system namespace</li>
</ul>
<h5 id="k8s-proxy">K8s Proxy<a aria-label="Link to this section" class="paige-header-link" href="#k8s-proxy"></a></h5>
<ul>
<li>K8s Proxy is responsible to route network traffic to load balanced services in cluster; the proxy runs in every node of the cluster</li>
<li>Is executed as an api object Daemonset (learn in Ch 11)</li>
</ul>
<pre tabindex="0"><code>$ kubectl get daemonSets --namespace=kube-system kube-proxy
NAME         DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR
kube-proxy   5         5         5       5            5           ...   45d
</code></pre><h5 id="k8s-dns">K8s DNS<a aria-label="Link to this section" class="paige-header-link" href="#k8s-dns"></a></h5>
<ul>
<li>DNS server provides naming and discovery for the services</li>
<li>Is executed as an api object deployment</li>
<li>cmd</li>
</ul>
<pre tabindex="0"><code>$ kubectl get deployments --namespace=kube-system core-dns
NAME       DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
core-dns   1         1         1            1           45d
</code></pre><h5 id="k8s-ui">K8s UI<a aria-label="Link to this section" class="paige-header-link" href="#k8s-ui"></a></h5>
<h1 id="4-common-kubectl-commands">4 Common Kubectl Commands<a aria-label="Link to this section" class="paige-header-link" href="#4-common-kubectl-commands"></a></h1>
<h3 id="41-namespaces">4.1 Namespaces<a aria-label="Link to this section" class="paige-header-link" href="#41-namespaces"></a></h3>
<ul>
<li>namespaces are used to organize objects in cluster; ~ a folder</li>
<li>==default== is the namespace by default
<ul>
<li>use &ndash;namespace to specify other name spaces</li>
<li>use &ndash;all-namespace for all namespaces</li>
</ul>
</li>
</ul>
<h3 id="42-contexts">4.2 Contexts<a aria-label="Link to this section" class="paige-header-link" href="#42-contexts"></a></h3>
<ul>
<li>
<p>To update/change what the default namespace, use context</p>
<ul>
<li>Value is stored in $HOME/.kube/config</li>
</ul>
</li>
<li>
<p>2 step procedure</p>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal"># Define the Context
kubectl config set-context my-context --namespace=mystuff

# Use the context
kubectl config use-context my-context
</code></pre><h3 id="43-viewing-k8s-api-objects">4.3 Viewing K8s API Objects<a aria-label="Link to this section" class="paige-header-link" href="#43-viewing-k8s-api-objects"></a></h3>
<ul>
<li>
<p>K8s objects is represented as a RESTFUL resource</p>
<ul>
<li>ie: <a href="https://your-k8s.com/api/v1/namespaces/default/pods/my-pod">https://your-k8s.com/api/v1/namespaces/default/pods/my-pod</a></li>
</ul>
</li>
<li>
<p>Get : For basic information</p>
<pre tabindex="0"><code>kubectl get &lt;resource-name&gt; &lt;obj-name&gt;

# more details
kubectl get &lt;resource-name&gt; &lt;obj-name&gt; -o wide

# specify output format (json or yaml)
kubectl get &lt;resource-name&gt; &lt;obj-name&gt; -o json

# skip header, to make it easier to use awk
kubectl get &lt;resource-name&gt; &lt;obj-name&gt; --no-headers

# pull specific information, using jsonpath query language
kubectl get pods my-pod -o jsonpath --template={.status.podIP}

# View multiple resources at once
kubectl get pods,services
</code></pre><ul>
<li>Describe for more information</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">	kubectl describe &lt;resource-name&gt; &lt;obj-name&gt;
</code></pre><ul>
<li>Explain: To see supported fields of a resource type
<ul>
<li>Ex: ktl explain pods</li>
</ul>
</li>
</ul>
<h3 id="44-create-update-destroy-k8s-objects">4.4 Create, Update, Destroy K8s Objects<a aria-label="Link to this section" class="paige-header-link" href="#44-create-update-destroy-k8s-objects"></a></h3>
<ul>
<li>K8s objects represented as json or yaml files</li>
<li>Via apply</li>
</ul>
<pre tabindex="0"><code>	ktl apply -f obj.yaml

	# Prints the object without sending to server
	ktl apply -f obj.yaml. --dry-run 

	# apply records a history of modification; one can backtrack to one of them with: edit-last-applied, set-last-applied, view-last-applied
	ktl apply -f myobj.yaml view-last-applied
</code></pre><ul>
<li>Via edit: interactive edit of an active k8s object</li>
</ul>
<pre tabindex="0"><code>	ktl edit &lt;resource-name&gt; &lt;obj-name&gt;
</code></pre><ul>
<li>Delete</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">
	ktl delete -f obj.yaml
	ktl delete &lt;resource-name&gt; &lt;obj-name&gt;
</code></pre><h3 id="45-labeling-and-annotating-objects">4.5 Labeling and Annotating Objects<a aria-label="Link to this section" class="paige-header-link" href="#45-labeling-and-annotating-objects"></a></h3>
<ul>
<li>Labels and annotations are tags for objects. Chap 6 discusses the difference between the two</li>
<li>Commands</li>
</ul>
<pre tabindex="0"><code>	ktl label pods bar color=red

	# To overwrite an existing label
	ktl label pods bar color=blue --overwrite

	# Remove the color label from pod
	ktl label podsbar color-
	
	
</code></pre><h3 id="46-debugging-commands">4.6 Debugging Commands<a aria-label="Link to this section" class="paige-header-link" href="#46-debugging-commands"></a></h3>
<pre tabindex="0"><code>	ktl logs pod-name
	
	# A pod can have multiple containers
	ktl log pod-name -c 

	# stream a log
	ktl log -f pod-name

	# Execute command in a running container
	ktl exec -it POD-NAME -- bash

	# If pod has no bash, one can attach
	ktl attach -it POD-NAME

	# Copy a file from running container to local machine
	ktl cp &lt;pod-name&gt;:&lt;/path/to/remote/file&gt; &lt;/path/to/local/file&gt;

	# Port forwarding; Forwards traffic from the local machine on port 8080 to the remote container on port 80
	ktl port-forward POD-NAME 8080:80

	# See events in hte given namespace
	ktl get events

	# Stream the events
	ktl get events --watch

	# Display CPU memory; may need to include namespace
	ktl top pods
</code></pre><h3 id="47-cluster-management">4.7 Cluster Management<a aria-label="Link to this section" class="paige-header-link" href="#47-cluster-management"></a></h3>
<ul>
<li>Cordon a node: prevent future pods from being scheduled on a particular node in cluster</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">	ktl cordon
	ktl drain
</code></pre><ul>
<li></li>
</ul>
<h3 id="48-command-autocompletion">4.8 Command Autocompletion<a aria-label="Link to this section" class="paige-header-link" href="#48-command-autocompletion"></a></h3>
<pre tabindex="0"><code># macOS
$ brew install bash-completion

# CentOS/Red Hat
$ yum install bash-completion

# Debian/Ubuntu
$ apt-get install bash-completion

brew install bash-completion
source &lt;(kubectl completion bash)
echo &#34;source &lt;(kubectl completion bash)&#34; &gt;&gt; ${HOME}/.bashrc
</code></pre><h3 id="49-alternative-way-of-viewing-cluster">4.9 Alternative Way of Viewing Cluster<a aria-label="Link to this section" class="paige-header-link" href="#49-alternative-way-of-viewing-cluster"></a></h3>
<ul>
<li>Via plugins
<ul>
<li>IntelliJ</li>
<li>Eclipse</li>
</ul>
</li>
<li>Graphical interface
<ul>
<li>Rancher Dashboard</li>
<li>Headlamp projects</li>
</ul>
</li>
</ul>
<h1 id="5-pods">5 Pods<a aria-label="Link to this section" class="paige-header-link" href="#5-pods"></a></h1>
<ul>
<li>
<p>A Pod is a collection of ==application containers== and ==volumes== running in the same execution environment. Pods, not containers, are the smallest deployable artifact in a Kubernetes cluster</p>
<ul>
<li>In some cases, multiple containers is symbiotic and should exist together, like the initContainer</li>
</ul>
</li>
<li>
<p>==How to decide if container should be together in 1 pod?==</p>
<ul>
<li>“Will these containers work correctly if they land on different machines?” If the answer is no, a Pod is the correct grouping for the containers</li>
</ul>
</li>
<li>
<p>pods are defined in a ==manifest==</p>
<ul>
<li>API server process these manifests and persist into the storage (etcd</li>
</ul>
</li>
<li>
<p>Create Pods</p>
<ul>
<li>Imperative</li>
</ul>
<pre tabindex="0"><code>    kubectl run kuard --generator=run-pod/v1  \ 
    --image=gcr.io/kuar-demo/kuard-amd64:blue
</code></pre><ul>
<li>Declarative (manfiest):
<ul>
<li>Ex kuard-pod.yaml
<ul>
<li>can also include health checks, resource limits (is described as per container)</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">http</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>kubectl apply -f kuard-pod.yaml</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Other commands</p>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">ktl get pods 
ktl get pods -o wide | json | yaml

ktl describe pods [POD-NAME, ie kuard]

ktl delete pods/[POD-NAME, ie kuard]
kubectl delete -f kuard-pod.yaml

# Log
kubectl logs kuard
kubectl logs kuard --previous # previous instance of pod, to investigate crash

# Run commands in container with exec
ktl exec -it kuard --date
kubectl exec -it kuard -- ash. # it is for interactive, so you can log in

# Port forward
kubectl port-forward kuard 8080:8080
</code></pre><ul>
<li>
<p>Using Volumes With Pods</p>
<ul>
<li>specs.volume : array defines all of the volumes that may be accessed by containers in the Pod manifest</li>
<li>volumeMounts: This array defines the volumes that are mounted into a particular container and the path where each volume should be mounted</li>
<li>IMOW: volume outlives the container life cycle, and can be consumed by other containers in the mod</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kuard-data&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/var/lib/kuard&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/data&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kuard-data&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">http</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">TCP</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Patterns of using volumes
<ul>
<li>communication/synchronization between containers in a pod.  Pod uses an empyDir volume which is scoped to pod&rsquo;s life span.</li>
<li>Cache</li>
<li>Persistent volume: use protocols like NFS, iSCSI, Amazon Elastic Block Store, Google Persistent Disk</li>
<li>Mounting to host filesystem, like the /dev filesystem to perform raw block level access to device.  Use ==hostPath== volume</li>
<li>For more details, refer chapter 16</li>
<li>Example:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Rest of pod definition above here</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kuard-data&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">nfs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l">my.nfs.server.local</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/exports&#34;</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="6-labels-and-annotations">6 Labels and Annotations<a aria-label="Link to this section" class="paige-header-link" href="#6-labels-and-annotations"></a></h1>
<h3 id="labels">Labels<a aria-label="Link to this section" class="paige-header-link" href="#labels"></a></h3>
<ul>
<li>Labels are key/value pairs that can be attached to Kubernetes objects such as Pods and ReplicaSets.</li>
<li>Sample commands</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">	kubectl run alpaca-prod \
	  --image=gcr.io/kuar-demo/kuard-amd64:blue \
	  --replicas=2 \
	  --labels=&#34;ver=1,app=alpaca,env=prod&#34;

	kubectl get deployments --show-labels

	# Modify labels
	kubectl label deployments alpaca-test &#34;canary=true&#34;
	kubectl get deployments -L canary

	# Remove labels, with -
	kubectl label deployments alpaca-test &#34;canary-&#34;
</code></pre><h3 id="label-selectors">Label Selectors<a aria-label="Link to this section" class="paige-header-link" href="#label-selectors"></a></h3>
<ul>
<li>Selectors are used to filter k8s objects based on set of labels</li>
<li>Commands</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c"># First show all the labels</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get pods --show-labels</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c"># NAME                              ... LABELS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c"># alpaca-prod-3408831585-4nzfb      ... app=alpaca,env=prod,ver=1,...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get pods --selector=&#34;ver=2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get pods --selector=&#34;app=bandicoot,ver=2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get pods --selector=&#34;app in (alpaca,bandicoot)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get deployments --selector=&#39;!canary&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kubectl get pods -l &#39;ver=2,!canary&#39;</span><span class="w">
</span></span></span></code></pre></div><h3 id="annotations">Annotations<a aria-label="Link to this section" class="paige-header-link" href="#annotations"></a></h3>
<ul>
<li>Labels vs Annotations
<ul>
<li>annotations are metadata to assist tools and libraries</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">		</span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    </span><span class="nt">example.com/icon-url</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://example.com/icon.png&#34;</span><span class="w">
</span></span></span></code></pre></div><h1 id="7-service-discovery-via-k8s-service-object">7 Service Discovery (Via K8s Service Object)<a aria-label="Link to this section" class="paige-header-link" href="#7-service-discovery-via-k8s-service-object"></a></h1>
<h3 id="71-what-is-service-discovery">7.1 What is Service Discovery<a aria-label="Link to this section" class="paige-header-link" href="#71-what-is-service-discovery"></a></h3>
<ul>
<li>Service-discovery tools help solve the problem of finding which processes are listening at which addresses for which services
<ul>
<li>Domain Name System (DNS) is an example.  K8s system is much more dynamic, java programs often often have stale mapping.</li>
</ul>
</li>
</ul>
<h3 id="72-the-service-object">7.2 The Service Object<a aria-label="Link to this section" class="paige-header-link" href="#72-the-service-object"></a></h3>
<ul>
<li>
<p>K8s service object deals with service discovery.</p>
<ul>
<li>It is a way to crate a named label selector</li>
</ul>
</li>
<li>
<p>K8s deployment is an instance of a micro service</p>
</li>
<li>
<p>Example of a K8s deployment</p>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">$ **kubectl create deployment alpaca-prod \
  --image=gcr.io/kuar-demo/kuard-amd64:blue \
  --port=8080**
$ **kubectl scale deployment alpaca-prod --replicas 3**
$ **kubectl expose deployment alpaca-prod**
$ **kubectl create deployment bandicoot-prod \
  --image=gcr.io/kuar-demo/kuard-amd64:green \
  --port=8080**
$ **kubectl scale deployment bandicoot-prod --replicas 2**
  **kubectl expose deployment bandicoot-prod**
$ **kubectl get services -o wide**

NAME             CLUSTER-IP    ... PORT(S)  ... SELECTOR
alpaca-prod      10.115.245.13 ... 8080/TCP ... app=alpaca
bandicoot-prod   10.115.242.3  ... 8080/TCP ... app=bandicoot
kubernetes       10.115.240.1  ... 443/TCP  ... &lt;none&gt;
</code></pre><ul>
<li>3 services
<ul>
<li>k8s service is automatically created, to talk to the K8s API from each of the 2 apps</li>
</ul>
</li>
<li>expose command pulls the label selector and relevant ports from the deployment definition</li>
<li>==Cluster IP== is a virtual IP address the system will load balance across all of the Pods that are identified by the selector</li>
<li>Port forward to one of the alpaca pods, from my mac with http://localhost:48858</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">$ ALPACA_POD=$(kubectl get pods -l app=alpaca \
    -o jsonpath=&#39;{.items[0].metadata.name}&#39;)
$ kubectl port-forward $ALPACA_POD 48858:8080
</code></pre><h5 id="service-dns">Service DNS<a aria-label="Link to this section" class="paige-header-link" href="#service-dns"></a></h5>
<ul>
<li>Cluster IP is virtual, so clients caching DNS is not an issue anymore.
<ul>
<li>Within a namespace, clients can just connect using the service name.  Like google.com</li>
</ul>
</li>
<li>Example of a full DNS:
<ul>
<li>alpaca-prod.default.svc.cluster.local
<ul>
<li>service name: alpaca-prod</li>
<li>namespace: default</li>
<li>svc: K8s can expost other types of DNS in the future</li>
<li>cluster.local: base domain for cluster; admins can modify</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="73-looking-beyond-the-cluster">7.3 Looking Beyond the Cluster<a aria-label="Link to this section" class="paige-header-link" href="#73-looking-beyond-the-cluster"></a></h3>
<ul>
<li>Previous section talks about how to communicate within cluster via services. How to talk to ==outside== the cluster? One way is with ==nodeport==
<ul>
<li>Enhances a service. In addition to cluster ip, a port is selected so other nodes in the cluster can forward traffic to that port in the service.
<ul>
<li>One can reach any service in any cluster node</li>
</ul>
</li>
<li>We then use a load balancer to expose the service to outside the cluster.</li>
</ul>
</li>
<li>Example: change a service to nodeport</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kubectl edit service alpaca-prod

change spec.type from service to NodePort

kubectl describe service alpaca-prod
	Name:                   alpaca-prod
	Namespace:              default
	Labels:                 app=alpaca
	Annotations:            &lt;none&gt;
	Selector:               app=alpaca
	Type:                   NodePort
	IP:                     10.115.245.13
	Port:                   &lt;unset&gt; 8080/TCP
	NodePort:               &lt;unset&gt; 32711/TCP
	Endpoints:              10.112.1.66:8080,10.112.2.104:8080,10.112.2.105:8080
	Session Affinity:       None
	No events.
	
ssh &lt;node&gt; -L 8080:localhost:32711
</code></pre><h3 id="74-load-balancer-integrations">7.4 Load Balancer Integrations<a aria-label="Link to this section" class="paige-header-link" href="#74-load-balancer-integrations"></a></h3>
<ul>
<li>Prereq: Update cluster to integrate with external loadbalancer.</li>
<li>Edit k8s nodeport to be loadbalancer
<ul>
<li>kubectl edit service alpaca-prod</li>
<li>configure the cloud to create a new load balancer and direct it at nodes in your cluster</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">
kubectl describe service alpaca-prod
	Name:                   alpaca-prod
	Namespace:              default
	Labels:                 app=alpaca
	Selector:               app=alpaca
	Type:                   LoadBalancer
	IP:                     10.115.245.13
	LoadBalancer Ingress:   104.196.248.204
	Port:                   &lt;unset&gt;	8080/TCP
	NodePort:               &lt;unset&gt;	32711/TCP
	Endpoints:              10.112.1.66:8080,10.112.2.104:8080,10.112.2.105:8080
	Session Affinity:       None
	Events:
	  FirstSeen ... Reason                Message
	  --------- ... ------                -------
	  3m        ... Type                  NodePort -&gt; LoadBalancer
	  3m        ... CreatingLoadBalancer  Creating load balancer
	  2m        ... CreatedLoadBalancer   Created load balancer

# service outslide of cluster can talk via the ip specified in LoadBalancer Ingress
</code></pre><h3 id="75-advanced-details">7.5 Advanced Details<a aria-label="Link to this section" class="paige-header-link" href="#75-advanced-details"></a></h3>
<h5 id="endpoints">Endpoints<a aria-label="Link to this section" class="paige-header-link" href="#endpoints"></a></h5>
<ul>
<li>Every k8s service is k8s endpoint</li>
<li>Endpoints contains all the IP address for that service; it does not use clusterI ip address</li>
<li>Applications can talk to K8s API to look up endpoints for a service.
<ul>
<li>Pods, nodes can change, but the endpoint always has the updated ips</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kubectl get endpoints alpaca-prod --watch
	NAME          ENDPOINTS                                            AGE
	alpaca-prod   10.112.1.54:8080,10.112.2.84:8080,10.112.2.85:8080   1m


# UPDATE service
$ kubectl delete deployment alpaca-prod
$ kubectl create deployment alpaca-prod \
  --image=gcr.io/kuar-demo/kuard-amd64:blue \
  --port=8080
$ kubectl scale deployment alpaca-prod --replicas=3

NAME          ENDPOINTS                                            AGE
alpaca-prod   10.112.1.54:8080,10.112.2.84:8080,10.112.2.85:8080   1m
alpaca-prod   10.112.1.54:8080,10.112.2.84:8080                    1m
alpaca-prod   &lt;none&gt;                                               1m
alpaca-prod   10.112.2.90:8080                                     1m
alpaca-prod   10.112.1.57:8080,10.112.2.90:8080                    1m
alpaca-prod   10.112.0.28:8080,10.112.1.57:8080,10.112.2.90:8080   1m
</code></pre><h5 id="kubeproxy-and-cluster-ips">KubeProxy and Cluster IPs<a aria-label="Link to this section" class="paige-header-link" href="#kubeproxy-and-cluster-ips"></a></h5>
<ul>
<li>kubeproxy maintains a node&rsquo;s cluster ip (iptables).  It runs in every node.
<ul>
<li>kube-proxy watches for new services via the API server</li>
</ul>
</li>
</ul>
<h3 id="76-connecting-with-other-environments">7.6 Connecting With Other Environments<a aria-label="Link to this section" class="paige-header-link" href="#76-connecting-with-other-environments"></a></h3>
<h3 id="77-cleanup">7.7 Cleanup<a aria-label="Link to this section" class="paige-header-link" href="#77-cleanup"></a></h3>
<h1 id="8-http-load-balancing-with-k8s-ingress">8 HTTP Load Balancing With ==k8s Ingress==<a aria-label="Link to this section" class="paige-header-link" href="#8-http-load-balancing-with-k8s-ingress"></a></h1>
<ul>
<li>For many users, service objects are sufficient.
<ul>
<li>Service objects operate at layer 4; it can only forward TCP and UDP connection.
<ul>
<li>service with cluster &ndash;&gt; use nodeport, ie a unique port</li>
<li>service outside cluster &ndash;&gt; use load balancer, but requires expensive loadbalancers</li>
</ul>
</li>
<li>For http (layer 7) based services, we can do better</li>
</ul>
</li>
<li>K8s Ingress implements http based load balancing
<ul>
<li>achieves &ldquo;Virtual hosting pattern&rdquo;: 1 IP address &ndash;&gt; multiple services</li>
<li>If I have 5 underlying backends, clients all call my 1 IP. But based on the http connection, proxies the request to one of my 5 underlying backend services</li>
</ul>
</li>
</ul>
<h3 id="81-ingress-spec-vs-ingress-controller">8.1 Ingress Spec Vs Ingress Controller<a aria-label="Link to this section" class="paige-header-link" href="#81-ingress-spec-vs-ingress-controller"></a></h3>
<h3 id="82-installing-contour">8.2 Installing Contour<a aria-label="Link to this section" class="paige-header-link" href="#82-installing-contour"></a></h3>
<h3 id="83-using-ingress">8.3 Using Ingress<a aria-label="Link to this section" class="paige-header-link" href="#83-using-ingress"></a></h3>
<h3 id="84--advance-ingress-topics-and-gotchas">8.4  Advance Ingress Topics and Gotchas<a aria-label="Link to this section" class="paige-header-link" href="#84--advance-ingress-topics-and-gotchas"></a></h3>
<h3 id="85-alternate-ingress-implementation">8.5 Alternate Ingress Implementation<a aria-label="Link to this section" class="paige-header-link" href="#85-alternate-ingress-implementation"></a></h3>
<h3 id="86-future-of-ingress">8.6 Future of Ingress<a aria-label="Link to this section" class="paige-header-link" href="#86-future-of-ingress"></a></h3>
<ul>
<li>has some intersection with k8s service mesh, discuss later</li>
</ul>
<h1 id="9-replicasets">9 ReplicaSets<a aria-label="Link to this section" class="paige-header-link" href="#9-replicasets"></a></h1>
<h1 id="10-deployments">10 Deployments<a aria-label="Link to this section" class="paige-header-link" href="#10-deployments"></a></h1>
<ul>
<li>K8s deployments
<ul>
<li>enables us to release a new version not tied to a new container image, ie artifacts, requirements.txt
<ul>
<li>K8s pods and replicasets are tied to a static container image</li>
</ul>
</li>
<li>handles rollout process</li>
<li>support health checks</li>
</ul>
</li>
</ul>
<h3 id="101-your-first-deployment">10.1 Your First Deployment<a aria-label="Link to this section" class="paige-header-link" href="#101-your-first-deployment"></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">	</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">$ kubectl create -f kuard-deployment.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">$ kubectl get deployments kuard \</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>-<span class="l">o jsonpath --template {.spec.selector.matchLabels}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span>{<span class="s2">&#34;run&#34;</span><span class="p">:</span><span class="s2">&#34;kuard&#34;</span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">$ kubectl scale deployments kuard --replicas=2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">$ **kubectl get replicasets --selector=run=kuard**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">NAME              DESIRED   CURRENT   READY     AGE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="l">kuard-1128242161  2         2         2         13m</span><span class="w">
</span></span></span></code></pre></div><h3 id="102-creating-deployment">10.2 Creating Deployment<a aria-label="Link to this section" class="paige-header-link" href="#102-creating-deployment"></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">deployment.kubernetes.io/revision</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">generation</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">progressDeadlineSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">600</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">revisionHistoryLimit</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">strategy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rollingUpdate</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">maxSurge</span><span class="p">:</span><span class="w"> </span><span class="m">25</span><span class="l">%</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">maxUnavailable</span><span class="p">:</span><span class="w"> </span><span class="m">25</span><span class="l">%</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">RollingUpdate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">creationTimestamp</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">terminationMessagePath</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/termination-log</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">terminationMessagePolicy</span><span class="p">:</span><span class="w"> </span><span class="l">File</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dnsPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterFirst</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">schedulerName</span><span class="p">:</span><span class="w"> </span><span class="l">default-scheduler</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">securityContext</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">terminationGracePeriodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">status</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span></code></pre></div><ul>
<li>new sections
<ul>
<li>strategy</li>
<li></li>
</ul>
</li>
</ul>
<h3 id="103-managing-deployments">10.3 Managing Deployments<a aria-label="Link to this section" class="paige-header-link" href="#103-managing-deployments"></a></h3>
<ul>
<li>kubectl describe deployments kuard</li>
</ul>
<h3 id="104-updating-deployments">10.4 Updating Deployments<a aria-label="Link to this section" class="paige-header-link" href="#104-updating-deployments"></a></h3>
<ul>
<li>could also use helm; k8s seems to be at a lower level</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">edit the deployment file

ktl apply -f deployment.yaml

ktl get deployments kuard

kubectl rollout status deployments kuard

kubectl rollout pause deployments kuard

kubectl rollout history deployment kuard
kubectl rollout history deployment kuard --revision=2

# undo a rollout
kubectl rollout undo deployments kuard
</code></pre><h3 id="105-deployment-strategies">10.5 Deployment Strategies<a aria-label="Link to this section" class="paige-header-link" href="#105-deployment-strategies"></a></h3>
<ul>
<li>Two strategies: recreate and rollingUpdate</li>
</ul>
<h5 id="recreate-strategy">Recreate Strategy<a aria-label="Link to this section" class="paige-header-link" href="#recreate-strategy"></a></h5>
<ul>
<li>It simply updates the ReplicaSet it manages to use the new image and terminates all of the Pods associated with the Deployment.</li>
<li>Simple, fast, and simple
<ul>
<li>but will result in workload downtime.</li>
<li>Should only be used for test deployments</li>
</ul>
</li>
</ul>
<h5 id="rollingupdate-strategy">RollingUpdate Strategy<a aria-label="Link to this section" class="paige-header-link" href="#rollingupdate-strategy"></a></h5>
<ul>
<li>Enables one to roll out a new version of your service while it is still receiving user traffic, without any downtime</li>
</ul>
<h5 id="slowing-rollouts-to-ensure-health">Slowing Rollouts to Ensure Health<a aria-label="Link to this section" class="paige-header-link" href="#slowing-rollouts-to-ensure-health"></a></h5>
<h3 id="106-deleting-a-deployment">10.6 Deleting a Deployment<a aria-label="Link to this section" class="paige-header-link" href="#106-deleting-a-deployment"></a></h3>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kubectl delete deployments kuard

kubectl delete -f kuard-deployment.yaml
</code></pre><h3 id="107-monitoring-a-deployment">10.7 Monitoring a Deployment<a aria-label="Link to this section" class="paige-header-link" href="#107-monitoring-a-deployment"></a></h3>
<ul>
<li>the status of the Deployment will transition to a failed state. This status can be obtained from the status.conditions array, where there will be a Condition whose Type is Progressing and whose Status is False</li>
</ul>
<h1 id="11-daemon-sets">11 Daemon Sets<a aria-label="Link to this section" class="paige-header-link" href="#11-daemon-sets"></a></h1>
<ul>
<li>Purpose is to schedule a single Pod on every node within the cluster. land some sort of agent or daemon on each node</li>
</ul>
<h3 id="111-daemonset-scheduler">11.1 DaemonSet Scheduler<a aria-label="Link to this section" class="paige-header-link" href="#111-daemonset-scheduler"></a></h3>
<ul>
<li>By default, a DaemonSet will create a copy of a Pod on every node unless a node selector is used</li>
</ul>
<h3 id="112-creating-daemonsets">11.2 Creating DaemonSets<a aria-label="Link to this section" class="paige-header-link" href="#112-creating-daemonsets"></a></h3>
<ul>
<li>Ex: Create a fluentd logging agent on every node</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">	</span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">fluentd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">fluentd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">fluentd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">fluent/fluentd:v0.14.10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l">200Mi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l">100m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l">200Mi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">varlog</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/log</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">varlibdockercontainers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/lib/docker/containers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">terminationGracePeriodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">varlog</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/var/log</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">varlibdockercontainers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/var/lib/docker/containers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">kubectl apply -f fluentd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">kubectl describe daemonset fluentd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">kubectl get pods -l app=fluentd -o wide</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">NAME            READY   STATUS    RESTARTS   AGE   IP             NODE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">fluentd-1q6c6   1/1     Running   0          13m   10.240.0.101   k0-default...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">fluentd-mwi7h   1/1     Running   0          13m   10.240.0.80    k0-default...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">fluentd-zr6l7   1/1     Running   0          13m   10.240.0.44    k0-default...</span><span class="w">
</span></span></span></code></pre></div><h3 id="113-limiting-daemsets-to-specific-nodes">11.3 Limiting DaemSets to Specific Nodes<a aria-label="Link to this section" class="paige-header-link" href="#113-limiting-daemsets-to-specific-nodes"></a></h3>
<ul>
<li>Add labels to nodes
<ul>
<li><strong>kubectl label nodes k0-default-pool-35609c18-z7tb ssd=true</strong></li>
<li><strong>kubectl get nodes &ndash;selector ssd=true</strong></li>
</ul>
</li>
<li>use the metadata.labels fiels</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">	</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DaemonSet&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">ssd</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-fast-storage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">ssd</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">ssd</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="nt">ssd</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	      </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx:1.10.0</span><span class="w">
</span></span></span></code></pre></div><h3 id="114-upading-a-daemsoneset">11.4 Upading a DaemsoneSet<a aria-label="Link to this section" class="paige-header-link" href="#114-upading-a-daemsoneset"></a></h3>
<h3 id="115-deleting-a-daemonset">11.5 Deleting a DaemonSet<a aria-label="Link to this section" class="paige-header-link" href="#115-deleting-a-daemonset"></a></h3>
<h1 id="12-jobs">12 Jobs<a aria-label="Link to this section" class="paige-header-link" href="#12-jobs"></a></h1>
<ul>
<li>Previously, we focus on long-running processes.</li>
<li>K8s job pods runs until successful termination, ie exit with 0
<ul>
<li>In contrast, non-job pods will keep restarting with exit with 0</li>
</ul>
</li>
</ul>
<h3 id="job-patterns">Job Patterns<a aria-label="Link to this section" class="paige-header-link" href="#job-patterns"></a></h3>
<ol>
<li>One shot
<ol>
<li>use case: database migrations</li>
<li>A single Pod running once until successful termination</li>
</ol>
</li>
<li>Parallel fixed completions
<ol>
<li>use case: Multiple Pods processing a set of work in</li>
<li>One or more Pods running one or more times until reaching a fixed completion count</li>
</ol>
</li>
<li>Worker queue: parallel jobs
<ol>
<li>use case: Multiple Pods processing from a centralized work queue</li>
<li>One or more Pods running once until successful termination</li>
</ol>
</li>
</ol>
<h3 id="cronjobs">Cronjobs<a aria-label="Link to this section" class="paige-header-link" href="#cronjobs"></a></h3>
<ul>
<li>
<p>Schedule a job to run at a certain interval</p>
</li>
<li>
<p>Example:</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">batch/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">CronJob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">example-cron</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Run every fifth hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;0 */5 * * *&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">jobTemplate</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">batch-job</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">my-batch-image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">OnFailure</span><span class="w">
</span></span></span></code></pre></div><h1 id="13-configmaps-and-secrets">13 ConfigMaps and Secrets<a aria-label="Link to this section" class="paige-header-link" href="#13-configmaps-and-secrets"></a></h1>
<h3 id="131-configmaps">13.1 ConfigMaps<a aria-label="Link to this section" class="paige-header-link" href="#131-configmaps"></a></h3>
<ul>
<li>A set of variables that can be used when defining the environment or command line for your containers
<ul>
<li>If a container image reads these environment variables, we can reuse the image for multiple workloads</li>
</ul>
</li>
</ul>
<h5 id="creating-a-configmap">Creating a ConfigMap<a aria-label="Link to this section" class="paige-header-link" href="#creating-a-configmap"></a></h5>
<ul>
<li>Example</li>
</ul>
<pre tabindex="0"><code># my-config.txt
# This is a sample config file that I might use to configure an application
parameter1 = value1
parameter2 = value2

$ kubectl create configmap my-config \
  --from-file=my-config.txt \
  --from-literal=extra-param=extra-value \
  --from-literal=another-param=another-value

$ kubectl get configmaps my-config -o yaml
apiVersion: v1
data:
  another-param: another-value
  extra-param: extra-value
  my-config.txt: |
    # This is a sample config file that I might use to configure an application
    parameter1 = value1
    parameter2 = value2
kind: ConfigMap
metadata:
  creationTimestamp: ...
  name: my-config
  namespace: default
  resourceVersion: &#34;13556&#34;
  selfLink: /api/v1/namespaces/default/configmaps/my-config
  uid: 3641c553-f7de-11e6-98c9-06135271a273
</code></pre><h5 id="using-a-configmap">Using a ConfigMap<a aria-label="Link to this section" class="paige-header-link" href="#using-a-configmap"></a></h5>
<ul>
<li>
<p>3 main ways to use configMaps</p>
<ol>
<li>File System:
<ol>
<li>You can mount a ConfigMap into a Pod. A file is created for each entry based on the key name. The contents of that file are set to the value.</li>
</ol>
</li>
<li>Environment Variable
<ol>
<li>A ConfigMap can be used to dynamically set the value of an environment variable.</li>
</ol>
</li>
<li>Command line argument
<ol>
<li>Kubernetes supports dynamically creating the command line for a container based on ConfigMap values.</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Example of all 3</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard-config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">test-container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;/kuard&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;$(EXTRA_PARAM)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># An example of an environment variable used inside the container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ANOTHER_PARAM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">configMapKeyRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l">another-param</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># An example of an environment variable passed to the command to start</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># the container (above).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">EXTRA_PARAM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">configMapKeyRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l">extra-param</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># Mounting the ConfigMap as a set of files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">config-volume</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">config-volume</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">configMap</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Never</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Filesystem:
<ul>
<li>We have to specify where this gets mounted into the kuard container with a ==volumeMount==  In this case, we are mounting it at /config</li>
</ul>
</li>
<li>Environment
<ul>
<li>Environment variables are specified with a special ==valueFrom== member.</li>
</ul>
</li>
</ul>
<h3 id="132-secrets">13.2 Secrets<a aria-label="Link to this section" class="paige-header-link" href="#132-secrets"></a></h3>
<ul>
<li>For configuration that are sensitive.</li>
</ul>
<h5 id="creating-secrets">Creating Secrets<a aria-label="Link to this section" class="paige-header-link" href="#creating-secrets"></a></h5>
<ul>
<li>Secrets hold 1 or more elements as a collection of key/value pairs</li>
<li>Steps
<ol>
<li>Download the secrets from somewhere
<ol>
<li>$ <strong>curl -o kuard.crt  <a href="https://storage.googleapis.com/kuar-demo/kuard.crt">https://storage.googleapis.com/kuar-demo/kuard.crt</a></strong></li>
<li><strong>curl -o kuard.key <a href="https://storage.googleapis.com/kuar-demo/kuard.key">https://storage.googleapis.com/kuar-demo/kuard.key</a></strong></li>
</ol>
</li>
<li>create the k8s secret
<pre tabindex="0"><code> kubectl create secret generic kuard-tls \
  --from-file=kuard.crt \
  --from-file=kuard.key**
</code></pre></li>
</ol>
``
3. Describe the secret
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kubectl describe secrets kuard-tls**
</code></pre></li>
</ul>
<h5 id="consuming-secrets">Consuming Secrets<a aria-label="Link to this section" class="paige-header-link" href="#consuming-secrets"></a></h5>
<ul>
<li>
<p>The kuard-tls Secret contains two data elements: kuard.crt and kuard.key. Mounting the kuard-tls Secrets volume to /tls results in the following files:</p>
</li>
<li>
<p>Ex:</p>
<ul>
<li>first, create the volume tls-certs, which is associated with the kuard-tls secret created above</li>
<li>then, container uses volumeMounts, which points to the volume tls-certs</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard-tls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">kuard-tls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">gcr.io/kuar-demo/kuard-amd64:blue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l">Always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tls-certs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/tls&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tls-certs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">secret</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">kuard-tls</span><span class="w">
</span></span></span></code></pre></div><h3 id="133-naming-constraints">13.3 Naming Constraints<a aria-label="Link to this section" class="paige-header-link" href="#133-naming-constraints"></a></h3>
<h3 id="134-managing-configmaps-and-secrets">13.4 Managing ConfigMaps and Secrets<a aria-label="Link to this section" class="paige-header-link" href="#134-managing-configmaps-and-secrets"></a></h3>
<h1 id="14-role-based-access-for-k8s">14 Role Based Access For K8s<a aria-label="Link to this section" class="paige-header-link" href="#14-role-based-access-for-k8s"></a></h1>
<ul>
<li>Role-based access control provides a mechanism for restricting both access to and actions on Kubernetes APIs
<ul>
<li>if you are focused on hostile multitenant security, RBAC by itself is sufficient to protect you</li>
<li>However, anyone who can run arbitrary code inside K8s cluster an obtain root privilege to entire cluster</li>
</ul>
</li>
<li>RBAC concept
<ul>
<li>Authentication: Authentication provides the identity of the caller issuing the request.
<ul>
<li>Using authentication provide, like Azure active directory</li>
<li>K8s has no built in identity store</li>
</ul>
</li>
<li>Authorization: what is the user authorized to perform?</li>
</ul>
</li>
</ul>
<h3 id="141-role-based-access-control">14.1 Role Based Access Control<a aria-label="Link to this section" class="paige-header-link" href="#141-role-based-access-control"></a></h3>
<h5 id="identity-in-k8s">Identity in K8s<a aria-label="Link to this section" class="paige-header-link" href="#identity-in-k8s"></a></h5>
<ul>
<li>Every request to Kubernetes is associated with some identity</li>
<li>Kubernetes uses a generic interface for authentication providers
<ul>
<li>HTTP Basic Authentication (largely deprecated)</li>
<li>x509 client certificates</li>
<li>Static token files on the host</li>
<li>Cloud authentication providers, such as Azure Active Directory and AWS Identity and Access Management (IAM)</li>
<li>Authentication webhooks</li>
</ul>
</li>
</ul>
<h5 id="understanding-roles-and-role-bindings">Understanding Roles and Role Bindings<a aria-label="Link to this section" class="paige-header-link" href="#understanding-roles-and-role-bindings"></a></h5>
<ul>
<li>Once Kubernetes knows the identity of the request, it needs to determine if the request is authorized for that user. To achieve this, it uses roles and role bindings.</li>
<li>A role is a set of abstract capabilities.
<ul>
<li>For example, the appdev role might represent the ability to create Pods and Services.</li>
</ul>
</li>
<li>A role binding is an assignment of a role to one or more identities.
<ul>
<li>Thus, binding the appdev role to the user identity alice indicates that Alice has the ability to create Pods and Services.</li>
</ul>
</li>
</ul>
<h5 id="roles-and-role-bindings-in-k8s">Roles and Role Bindings in K8s<a aria-label="Link to this section" class="paige-header-link" href="#roles-and-role-bindings-in-k8s"></a></h5>
<ul>
<li>Role and role bindings:
<ul>
<li>name space level
<ul>
<li>role, role binding</li>
</ul>
</li>
<li>cluster level
<ul>
<li>clusterRole, clusterRoleBinding</li>
</ul>
</li>
</ul>
</li>
<li>Example: Role</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">	</span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-and-services</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;pods&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;services&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;create&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;delete&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;patch&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;update&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Example: Role Binding</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">	</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">RoleBinding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pods-and-services</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span>- <span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">User</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">alice</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span>- <span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Group</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mydevs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-and-services</span><span class="w">
</span></span></span></code></pre></div><h3 id="142-techniques-for-managing-rbac">14.2 Techniques for Managing RBAC<a aria-label="Link to this section" class="paige-header-link" href="#142-techniques-for-managing-rbac"></a></h3>
<h5 id="testing-authorization-with-can-i">Testing Authorization with can-i<a aria-label="Link to this section" class="paige-header-link" href="#testing-authorization-with-can-i"></a></h5>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">kubectl auth can-i create pods

# test subresources like logs or port-forwarding with the --subresource
kubectl auth can-i get pods --subresource=logs
</code></pre><h5 id="managing-rbac-in-source-control">Managing RBAC in Source Control<a aria-label="Link to this section" class="paige-header-link" href="#managing-rbac-in-source-control"></a></h5>
<ul>
<li>The kubectl command-line tool provides a reconcile command that operates somewhat like kubectl apply and will reconcile a set of roles and role bindings with the current state of the cluster. You can run:</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">$ kubectl auth reconcile -f some-rbac-config.yaml
</code></pre><h3 id="143-advanced-topics">14.3 Advanced Topics<a aria-label="Link to this section" class="paige-header-link" href="#143-advanced-topics"></a></h3>
<h5 id="aggregating-clusterroles">Aggregating ClusterRoles<a aria-label="Link to this section" class="paige-header-link" href="#aggregating-clusterroles"></a></h5>
<h5 id="using-groups-for-bindings">Using Groups for Bindings<a aria-label="Link to this section" class="paige-header-link" href="#using-groups-for-bindings"></a></h5>
<h1 id="15-service-mesh">15 Service Mesh<a aria-label="Link to this section" class="paige-header-link" href="#15-service-mesh"></a></h1>
<ul>
<li>Previous K8s network primitives: services, ingress</li>
<li>Both Service and Ingress resources have label selectors that route traffic to a particular set of Pods, but beyond that there is comparatively little in the way of additional capabilities that these resources bring. As an HTTP load balancer, Ingress goes a little beyond this, but the challenge of defining a common API that fits a wide variety of different existing implementations limits the capabilities in the Ingress API</li>
<li>Service mesh APIs provide additional ==cloud native== networking capabilities. See each section below to see what cloud native means.</li>
</ul>
<h5 id="feature-encryption-and-authentication-with-mutual-tls">Feature: Encryption and Authentication with Mutual TLS<a aria-label="Link to this section" class="paige-header-link" href="#feature-encryption-and-authentication-with-mutual-tls"></a></h5>
<ul>
<li>Service mesh on your Kubernetes cluster automatically provides encryption to network traffic between every Pod in the cluster
<ul>
<li>consistent implementation across all deployments</li>
</ul>
</li>
</ul>
<h5 id="feature-traffic-shaping">Feature: Traffic Shaping<a aria-label="Link to this section" class="paige-header-link" href="#feature-traffic-shaping"></a></h5>
<ul>
<li>Traffic shaping = Routing of requests to different service implementations based on the characteristics of the request
<ul>
<li>Isn&rsquo;t this just &ldquo;virtual hosting&rdquo;?</li>
</ul>
</li>
<li>Example: A/B Testing
<ul>
<li>Instead of writing code to implement your experiment, or deploying an entirely new copy of your application on new infrastructure, you declaratively define the parameters of the experiment (10% of traffic to version Y, 90% of traffic to version X), and the service mesh implements it for you.</li>
<li>Was this the feature flag we saw in NPD?</li>
</ul>
</li>
</ul>
<h5 id="feature-introspection">Feature: Introspection<a aria-label="Link to this section" class="paige-header-link" href="#feature-introspection"></a></h5>
<ul>
<li>Instead of seeing a flurry of requests to a bunch of different microservices, the developer can see a single aggregate request that defines the user experience of their complete application.
<ul>
<li>Is this the aggregate logging solution I wanted ?</li>
</ul>
</li>
<li>The service mesh is implemented once for an entire cluster. This means that the same request tracing works no matter which team developed the service. The monitoring data is entirely consistent across all of the different services joined together by a cluster-wide service mesh.</li>
<li></li>
</ul>
<h5 id="do-you-really-need-service-mesh">Do You Really Need Service Mesh?<a aria-label="Link to this section" class="paige-header-link" href="#do-you-really-need-service-mesh"></a></h5>
<ul>
<li>A service mesh is a distributed system that adds complexity to your application design. The service mesh is deeply integrated into the core communication of your microservices. When a service mesh fails, your entire application stops working.</li>
</ul>
<h5 id="service-mesh-landscape">Service Mesh Landscape<a aria-label="Link to this section" class="paige-header-link" href="#service-mesh-landscape"></a></h5>
<ul>
<li>Open source:
<ul>
<li>Istio,  Linkerd, Consul Connect, Open Service Mesh, and others.</li>
</ul>
</li>
<li>There are also proprietary meshes like AWS App Mesh.</li>
</ul>
<h1 id="16-integrating-storage-solutions-and-k8s">16 Integrating Storage Solutions And K8s<a aria-label="Link to this section" class="paige-header-link" href="#16-integrating-storage-solutions-and-k8s"></a></h1>
<h1 id="17-extending-k8s">17 Extending K8s<a aria-label="Link to this section" class="paige-header-link" href="#17-extending-k8s"></a></h1>
<h1 id="18-accessing-k8s-from-common-programming-language">18 Accessing K8s From Common Programming Language<a aria-label="Link to this section" class="paige-header-link" href="#18-accessing-k8s-from-common-programming-language"></a></h1>
<h1 id="19-securing-applications-in-k8s">19 Securing Applications in K8s<a aria-label="Link to this section" class="paige-header-link" href="#19-securing-applications-in-k8s"></a></h1>
<h1 id="20-policy-and-governance-for-k8s-clusters">20 Policy and Governance For K8s Clusters<a aria-label="Link to this section" class="paige-header-link" href="#20-policy-and-governance-for-k8s-clusters"></a></h1>
<h1 id="21-multi-cluster-application-deployments">21 Multi cluster Application Deployments<a aria-label="Link to this section" class="paige-header-link" href="#21-multi-cluster-application-deployments"></a></h1>
<h1 id="22-organizing-your-application">22 Organizing Your Application<a aria-label="Link to this section" class="paige-header-link" href="#22-organizing-your-application"></a></h1>
<h3 id="221-principles-to-guide-us">22.1 Principles to Guide Us<a aria-label="Link to this section" class="paige-header-link" href="#221-principles-to-guide-us"></a></h3>
<h5 id="filesystems-as-the-source-of-truth">Filesystems as the Source of Truth<a aria-label="Link to this section" class="paige-header-link" href="#filesystems-as-the-source-of-truth"></a></h5>
<ul>
<li>Rather than viewing the state of the cluster—the data in <code>etcd</code>—as the source of truth, it is optimal to view the filesystem of YAML objects as the source of truth for your application.</li>
</ul>
<h5 id="role-of-code-review">Role of Code Review<a aria-label="Link to this section" class="paige-header-link" href="#role-of-code-review"></a></h5>
<ul>
<li>Ensuring that at least two people look at any configuration change significantly decreases the probability of errors.</li>
</ul>
<h5 id="feature-gates">Feature Gates<a aria-label="Link to this section" class="paige-header-link" href="#feature-gates"></a></h5>
<ul>
<li>
<p>Should application source code and k8s configuration files (aka source of truth) be in separate git repositories?</p>
<ul>
<li>Yes, the perspectives of the builder versus those of the deployer are different enough that this separation of concerns makes sense</li>
</ul>
</li>
<li>
<p>How do you bridge the development of new features in source control with the deployment of those features into a production environment?</p>
<ul>
<li>with feature flags</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">featureFlags</span><span class="o">.</span><span class="n">myFlag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">Feature</span> <span class="n">implementation</span> <span class="n">goes</span> <span class="n">here</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="222-managing-your-application-in-source-control">22.2 Managing Your Application in Source Control<a aria-label="Link to this section" class="paige-header-link" href="#222-managing-your-application-in-source-control"></a></h3>
<h5 id="file-system-layout">File System Layout<a aria-label="Link to this section" class="paige-header-link" href="#file-system-layout"></a></h5>
<ul>
<li>organize your application is the semantic component or layer (for instance, frontend or batch work queue)
<ul>
<li>Rationale: Goal is to be able scale teams, where each team is responsible for a component and layer</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>frontend/
   frontend-deployment.yaml
   frontend-service.yaml
   frontend-ingress.yaml
service-1/
   service-1-deployment.yaml
   service-1-service.yaml
   service-1-configmap.yaml
   
</code></pre><h5 id="managing-periodic-versions-of-the-deployment">Managing Periodic Versions of the Deployment<a aria-label="Link to this section" class="paige-header-link" href="#managing-periodic-versions-of-the-deployment"></a></h5>
<ul>
<li>It is handy to be able to simultaneously store and maintain multiple revisions of your configuration.</li>
<li>Options</li>
</ul>
<ol>
<li>Use (git) tags, branches, and source-control features. This is convenient because it maps to the way people manage revisions in source control, and leads to a more simplified directory structure</li>
<li>Clone the configuration within the filesystem and use directories for different revisions.</li>
</ol>
<ul>
<li>
<p>Option 1 in more details</p>
<ul>
<li>When you are ready for a release, you place a source-control tag (such as git tag v1.0) in the configuration source-control system. The tag represents the configuration used for that version, and the HEAD of source control continues to iterate forward.</li>
<li>Updating the release configuration is somewhat more complicated, but the approach models what you would do in source control. First, you commit the change to the HEAD of the repository. Then you create a new branch named v1 at the v1.0 tag. You cherry-pick the desired change onto the release branch (git cherry-pick edit), and finally, you tag this branch with the v1.1 tag to indicate a new point release.</li>
</ul>
</li>
<li>
<p>Option 2 in more details</p>
</li>
</ul>
<pre tabindex="0"><code>	frontend/
	  v1/
		frontend-deployment.yaml
		frontend-service.yaml
	  current/
		frontend-deployment.yaml
		frontend-service.yaml
	service-1/
	  v1/
		 service-1-deployment.yaml
		 service-1-service.yaml
	  v2/
		 service-1-deployment.yaml
		 service-1-service.yaml
	  current/
		 service-1-deployment.yaml
		 service-1-service.yaml
</code></pre><h3 id="223-structuring-application-for-development-testing-and-deployment">22.3 Structuring Application for Development, Testing, and Deployment<a aria-label="Link to this section" class="paige-header-link" href="#223-structuring-application-for-development-testing-and-deployment"></a></h3>
<h3 id="224-parameterizing-application-with-templates">22.4 Parameterizing Application with Templates<a aria-label="Link to this section" class="paige-header-link" href="#224-parameterizing-application-with-templates"></a></h3>
<ul>
<li>Parameterized environments use templates for the bulk of their configuration, but they mix in a limited set of parameters to produce the final configuration.</li>
</ul>
<h5 id="parameterizing-with-helm-and-templates">Parameterizing with Helm and Templates<a aria-label="Link to this section" class="paige-header-link" href="#parameterizing-with-helm-and-templates"></a></h5>
<ul>
<li>
<p>helm uses &ldquo;mustache syntax&rdquo;</p>
<ul>
<li>Ex: deployment.yaml</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span>{{<span class="w"> </span><span class="l">.Release.Name }}-deployment</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>Values.yaml
<ul>
<li>we have separate values.yaml for each of our environments, ie dev, stage, test</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Release</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">my-release</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>helm uses values.yaml to populate the k8s resource file.
``</p>
</li>
</ul>
<h3 id="225-deploying-application-around-the-world">22.5 Deploying Application Around the World<a aria-label="Link to this section" class="paige-header-link" href="#225-deploying-application-around-the-world"></a></h3>
<ul>
<li>Adding multiple regions to your configuration is identical to adding new life cycle stages</li>
</ul>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">frontend/
  staging/
    templates -&gt; ../v3/
    parameters.yaml
  eastus/
    templates -&gt; ../v1/
    parameters.yaml
  westus/
    templates -&gt; ../v2/
    parameters.yaml
  ...
</code></pre><h1 id="appendix-building-your-own-k8s-cluster">Appendix: Building Your Own K8s Cluster<a aria-label="Link to this section" class="paige-header-link" href="#appendix-building-your-own-k8s-cluster"></a></h1>
</div>


    </div>
</article>




    
    



    



    



    



    



    



    



    



    







                        
                    </main>

                    









    

    


<footer class="mb-3" id="paige-footer">
    

    
        <div class="mb-3" id="paige-prev-next">
            
                <p class="mb-0 text-center text-secondary" id="paige-next">
                    <a class="link-secondary" href="http://localhost:1313/books/software-system/learning-algorithms/">Learning Algorithms</a> &rsaquo;
                </p>
            

            
                <p class="mb-0 text-center text-secondary" id="paige-prev">
                    &lsaquo; <a class="link-secondary" href="http://localhost:1313/books/software-system/grpc-up-and-running/"></a>
                </p>
            
        </div>
    

    

    

    

    
</footer>

                </div>
            </div>
        </div>

        















    
    
    


<script  crossorigin="anonymous"   defer  integrity="sha256-gfPiYYSP&#43;RNtNeRBt45mJombFJmNf0V0Ipu785Obi0M="   referrerpolicy="no-referrer"  src="/js/paige/bootstrap/bootstrap.bundle.min.81f3e261848ff9136d35e441b78e6626899b14998d7f4574229bbbf3939b8b43.js" ></script>



    













    
    
    


<script  crossorigin="anonymous"   defer  integrity="sha256-kqnbKZyzZFmn0J2JtRxwdeNh0b3FknYDyAd&#43;mGKI73c="   referrerpolicy="no-referrer"  src="/js/paige/katex/katex.min.min.92a9db299cb36459a7d09d89b51c7075e361d1bdc5927603c8077e986288ef77.js" ></script>

    













    
    
    


<script  crossorigin="anonymous"   defer  integrity="sha256-pQMCGuz&#43;5jpyog4zEVyH/xvxJRsPM9M7d7t6&#43;TiyEA8="  onload="renderMathInElement(document.body);"   referrerpolicy="no-referrer"  src="/js/paige/katex/auto-render.min.min.a503021aecfee63a72a20e33115c87ff1bf1251b0f33d33b77bb7af938b2100f.js" ></script>






    



    



    



    



    



    



    



    



    



    



    



    



    



    



    





<noscript>JavaScript is required</noscript>


        
    </body>
</html>
